machine:
  services:
    - docker
  ruby:
    version: 2.1.3

dependencies:
  pre:
    - docker pull aussielunix/fpm-cook:ubuntu_14.04
    - gem install package_cloud

test:
  override:
    - docker run -v $PWD:/data/ -i -t aussielunix/fpm-cook:ubuntu_14.04 fpm-cook package -t deb -p ubuntu recipe.rb

general:
  artifacts:
    - /home/ubuntu/packer-packages/pkg/

deployment:
  production:
    branch: master
    commands:
      - package_cloud push aussielunix/packer/ubuntu/14.04 $CIRCLE_ARTIFACTS/packer_0.7.2-1_amd64.deb
